<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>StudioPro AI | Industrial Designer</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
</head>
<body>

    <div class="app-container">
        <aside class="sidebar">
            <div class="brand">
                <div class="logo-icon">‚ú®</div>
                <h2>StudioPro</h2>
            </div>

            <div class="user-profile" onclick="openAuth('login')">
                <div class="avatar">
                    {% if logged_in %}üë§{% else %}üîí{% endif %}
                </div>
                <div class="user-info">
                    <p>{% if logged_in %}{{ username }}{% else %}Secure Sign In{% endif %}</p>
                </div>
            </div>

            <nav>
                <a href="#" class="nav-item active">
                    <span class="icon">üé®</span> AI Designer
                </a>
                <a href="#history" class="nav-item">
                    <span class="icon">üìÇ</span> My Assets
                    {% if history|length > 0 %}<span class="count">{{ history|length }}</span>{% endif %}
                </a>
                
                <a href="#" class="nav-item" onclick="showQRCode()">
                    <span class="icon">üì±</span> Install App
                </a>

                {% if logged_in %}
                <a href="/logout" class="nav-item" style="color: #ef4444; margin-top: auto;">
                    <span class="icon">üö™</span> Logout
                </a>
                {% endif %}
            </nav>
        </aside>

        <main class="main-content">
            <header>
                <h1>Industrial Image Stylization</h1>
                <p>High-fidelity asset generation for professionals</p>
            </header>

            <div class="workspace">
                <div class="panel config">
                    <h3>1. Configuration</h3>
                    
                    <div class="upload-area" onclick="document.getElementById('fileInput').click()">
                        <div class="icon">üì§</div>
                        <p>Click, Drag, or <b>Paste (Ctrl+V)</b></p>
                        <input type="file" id="fileInput" hidden accept="image/*">
                    </div>
                    
                    <div class="controls">
                        <label class="control-label">Select Algorithm</label>
                        <div class="radio-stack">
                            <label class="radio-opt">
                                <input type="radio" name="style" value="cartoon" checked>
                                <span>üé® Cartoonify</span>
                            </label>
                            <label class="radio-opt">
                                <input type="radio" name="style" value="pencil">
                                <span>‚úèÔ∏è Pencil Sketch</span>
                            </label>
                            <label class="radio-opt premium">
                                <input type="radio" name="style" value="anime">
                                <span>‚ú® Ghibli Anime</span>
                            </label>
                            <label class="radio-opt premium">
                                <input type="radio" name="style" value="cyberpunk">
                                <span>üåÜ Cyberpunk</span>
                            </label>
                            <label class="radio-opt premium">
                                <input type="radio" name="style" value="hdr">
                                <span>üì∏ HDR Detail</span>
                            </label>
                        </div>
                    </div>

                    <button class="btn-primary" onclick="generate()">GENERATE ASSET</button>
                    
                    <a id="dlBtn" href="#" class="btn-download hidden" download="studio_pro_asset.png" target="_blank">
                        Download HD Asset
                    </a>
                </div>

                <div class="panel viewer">
                    <h3>2. Interactive Comparison</h3>
                    
                    <div class="compare-container" id="compContainer">
                        <div class="img-wrapper background">
                            <span class="label">After</span>
                            <img id="processedImg" src="https://via.placeholder.com/800x600/0f172a/334155?text=Generated+Output" alt="After">
                        </div>
                        
                        <div class="img-wrapper foreground" id="foregroundWrapper">
                            <span class="label">Before</span>
                            <img id="originalImg" src="https://via.placeholder.com/800x600/020617/1e293b?text=Original+Input" alt="Before">
                        </div>
                        
                        <input type="range" min="0" max="100" value="50" class="slider" id="compareSlider" oninput="moveSlider()">
                        <div class="slider-button" id="sliderBtn">‚Üî</div>
                    </div>
                    <p class="caption">Drag the slider to compare Before vs After</p>
                </div>
            </div>

            {% if logged_in and history %}
            <div id="history" class="history-section">
                <h3>üìÇ Project History</h3>
                <div class="history-grid">
                    {% for item in history %}
                    <div class="h-card" id="card-{{ item.id }}">
                        <img src="{{ item.image_url }}">
                        <div class="h-info">
                            <span>{{ item.style }}</span>
                            <div class="h-actions">
                                <a href="{{ item.image_url }}" target="_blank" class="btn-icon">‚¨áÔ∏è</a>
                                <button onclick="deleteAsset({{ item.id }})" class="btn-icon delete">üóëÔ∏è</button>
                            </div>
                        </div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

        </main>
    </div>

    <div id="authModal" class="modal hidden">
        <div class="modal-box">
            <button class="close-btn" onclick="closeAuth()">√ó</button>
            
            <div id="loginForm">
                <h2>Welcome Back</h2>
                <input type="text" id="l_user" placeholder="Username">
                <input type="password" id="l_pass" placeholder="Password">
                <button class="btn-primary" onclick="submitAuth('/login')">Sign In</button>
                <p class="switch-link" onclick="switchMode('register')">New here? Create Account</p>
            </div>

            <div id="registerForm" class="hidden">
                <h2>Create Account</h2>
                <input type="text" id="r_user" placeholder="Choose Username">
                <input type="password" id="r_pass" placeholder="Create Password">
                <button class="btn-primary" onclick="submitAuth('/register')">Register</button>
                <p class="switch-link" onclick="switchMode('login')">Already have an account? Sign In</p>
            </div>
            <p id="authError" style="color:red; font-size:12px; margin-top:10px;"></p>
        </div>
    </div>

    <div id="loader" class="loader-overlay hidden">
        <div class="spinner"></div>
        <p>Rendering High-Fidelity Asset...</p>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
